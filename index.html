<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>全球恐怖袭击大数据分析</title>
    <link href="css/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">

    <style>
        .t_title{
            width: 100%;
            height: 100%;
            text-align: center;
            font-size: 2.5em;
            line-height: 80px;
            color: #fff;
        }
        #chart_map{
            cursor: pointer;
        }
        .t_show{
            position: absolute;
            top: 0;
            right: 0;
            border-radius: 2px;
            background: url(bk2.jpg);
            padding: 2px 5px;
            color: #fff;
            cursor: pointer;
        }
    
        

    </style>
</head>
<body>

<!--header-->
<div class="header">
    <div class="bg_header">
        <div class="header_nav fl t_title">
            全球恐怖袭击大数据分析
        </div> 
    </div>
</div>

<!--main-->
<div class="data_content">
    <div class="data_time">
        ps:雷达图选取了美国50年的数据，其他均为全球数据。        
    </div>

    <div class="data_main">
        <div class="main_left fl">
            <div class="left_1 t_btn6" style="cursor: pointer;">
                <!--左上边框-->
                <div class="t_line_box">
                    <i class="t_l_line"></i> 
                    <i class="l_t_line"></i> 
                </div> 
                <!--右上边框-->
                <div class="t_line_box">
                    <i class="t_r_line"></i> 
                    <i class="r_t_line"></i> 
                </div> 
                <!--左下边框-->
                <div class="t_line_box">
                    <i class="l_b_line"></i> 
                    <i class="b_l_line"></i> 
                </div> 
                    <!--右下边框-->
                    <div class="t_line_box">
                    <i class="r_b_line"></i> 
                    <i class="b_r_line"></i> 
                </div> 


                <div id="container1" style="height: 100%"></div>

  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/dataTool.min.js"></script>
  -->

  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
 
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom = document.getElementById('container1');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    var ROOT_PATH = 'https://echarts.apache.org/examples';
    var option;

    $.getJSON('./population.json', function (data) {
      console.log(data);
  data = data
    .filter(function (dataItem) {
      return dataItem[2] > 0;
    })
    .map(function (dataItem) {
      return [dataItem[0], dataItem[1], dataItem[2]];
    });

    console.log(data);
    option = {
    backgroundColor: '#000',
    globe: {
      baseTexture: 'world.topo.bathy.200401.jpg',
      heightTexture:  './bathymetry_bw_composite_4k.jpg',
      shading: 'lambert',
      environment: './img/bk2.png',
      light: {
        ambient: {
          intensity: 1
        },
        main: {
          intensity: 1
        }
      },
      viewControl: {
        autoRotate: true
      }
    },
    title: {
            text: '1970-2020年全球恐怖袭击发生次数分布',
            left: 'center',
            top: 'top',
            textStyle: {
                fontSize: 15,
                color: 'rgba(255,255,255, 0.9)'
            }
        },
    visualMap: {
      max: 100,
      calculable: true,
      realtime: false,
      inRange: {
        colorLightness: [0.2, 0.6]
      },
      textStyle: {
        color: '#fff'
      },
      controller: {
        inRange: {
          color: 'red'
        }
      },
      outOfRange: {
        colorAlpha: 0
      }
    },
    series: [
      {
        type: 'bar3D',
        coordinateSystem: 'globe',
        data: data,
        barSize: 0.6,
        minHeight: 0.2,
        silent: true,
        itemStyle: {
          color: 'red'
        }
      }
    ]
  };
  myChart.setOption(option);
});

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
  </script>




                
            </div>



            <div class="left_2" style="cursor: pointer;">
                <!--左上边框-->
                <div class="t_line_box">
                    <i class="t_l_line"></i> 
                    <i class="l_t_line"></i> 
                </div> 
                <!--右上边框-->
                <div class="t_line_box">
                    <i class="t_r_line"></i> 
                    <i class="r_t_line"></i> 
                </div> 
                <!--左下边框-->
                <div class="t_line_box">
                    <i class="l_b_line"></i> 
                    <i class="b_l_line"></i> 
                </div> 
                    <!--右下边框-->
                    <div class="t_line_box">
                    <i class="r_b_line"></i> 
                    <i class="b_r_line"></i> 
                </div> 
               
  <div id="container5" style="height: 100%"></div>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom1 = document.getElementById('container5');
    var myChart1 = echarts.init(dom1, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    
    var option;

    option = {

  tooltip: {
    trigger: 'axis'
  },
  title: {
            text: '1970-2020年美国恐怖袭击数据雷达图',
            left: 'center',
            top: 'bottom',
            textStyle: {
                fontSize: 15,
                color: 'rgba(255,255,255, 0.9)'
            }
        },
  legend: {
    data: ['1970-1980', '1980-1990','1990-2000',
    '2000-2010','2010-2020'],
    orient: 'vertical', // 设置图例垂直排列
    top: '0px', // 调整上边距
    left: '10px', // 调整左边距
    itemWidth: 15, // 调整图例项的宽度
    itemHeight: 7, // 调整图例项的高度
    textStyle: {
    fontSize:8,
    color: '#fff' // 修改字体颜色为白色
  }
  },
  grid: {
    top: '0px', // 调整图表上边距，添加留白
    bottom: '0px'
  },
  radar: {
    top:'0px',
    // shape: 'circle',
    areaStyle: {},
    tooltip: {
        trigger: 'item'
      },
    indicator: [
      { text: '肇事者人数', max: 150 },
      { text: '被肇事者人数', max: 250 },
      { text: '受害者死亡总人数', max: 350 },
      { text: '肇事者死亡人数', max: 120 },
      { text: '受伤人数', max: 900 },
    ],
    axisLabel: {
      color: '#fff' // 设置轴标签文本颜色为白色
    }
  },
  series: [
    {
      name: 'American kongbu',
      type: 'radar',
      tooltip: {
        trigger: 'item'
      },
      areaStyle: {},
      data: [
        {
          value: [132, 13, 95, 60, 365],
          name: '1970-1980'
        },
        {
          value: [99,228,129,101,873],
          name: '1980-1990'
        },
        {
          value: [38,231,327,83,831],
          name: '1990-2000'
        },
        {
          value: [4,220,108,79,10],
          name: '2000-2010'
        } ,
        {
          value: [7,13,91,56,22],
          name: '2010-2020'
        }
      ]
    }
  ]
};

    if (option && typeof option === 'object') {
      myChart1.setOption(option);
    }

    window.addEventListener('resize', myChart1.resize);
  </script>
            </div>
        </div>
        <div class="main_center fl">
            <div class="center_text">
                <!--左上边框-->
                <div class="t_line_box">
                    <i class="t_l_line"></i> 
                    <i class="l_t_line"></i> 
                </div> 
                <!--右上边框-->
                <div class="t_line_box">
                    <i class="t_r_line"></i> 
                    <i class="r_t_line"></i> 
                </div> 
                <!--左下边框-->
                <div class="t_line_box">
                    <i class="l_b_line"></i> 
                    <i class="b_l_line"></i> 
                </div> 
                 <!--右下边框-->
                 <div class="t_line_box">
                    <i class="r_b_line"></i> 
                    <i class="b_r_line"></i> 
                </div> 




    <div id="chart-panel" style="height: 100%;width: 100%"></div>
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <!-- <script type="text/javascript" src="http://zhangmuchen.top/file/dep/echarts/map/js/world.js"></script> -->

    <script type="text/javascript">
      var dom = document.getElementById("chart-panel");
      var myChart = echarts.init(dom);
      var option;
      var app = {};
    
      function loadMap(mapName) {
          var mapData;
          if (mapName != "world") {
              mapData = './map/' + mapName + '.json';
          }
          else {
              mapData = './world.json';
          }
          $.getJSON(mapData, function (mapJson) {
              echarts.registerMap(mapName, mapJson);
    
              $.getJSON("./1970-1980country.json", function (data) {
    
                  var mapOption = {
                      baseOption: {
                          animationDurationUpdate: 1000,
                          animationEasingUpdate: 'quinticInOut',
                          timeline: {
                              axisType: 'category',
                              orient: 'vertical',
                              autoPlay: true,
                              inverse: true,
                              playInterval: 5000,
                              left: null,
                              right: 5,
                              top: 20,
                              bottom: 20,
                              width: 46,
                              height: null,
                              label: {
                                  normal: {
                                      textStyle: {
                                          color: '#ddd'
                                      }
                                  },
                                  emphasis: {
                                      textStyle: {
                                          color: '#fff'
                                      }
                                  }
                              },
                              symbol: 'none',
                              lineStyle: {
                                  color: '#555'
                              },
                              checkpointStyle: {
                                  color: '#bbb',
                                  borderColor: '#777',
                                  borderWidth: 1
                              },
                              controlStyle: {
                                  showNextBtn: false,
                                  showPrevBtn: false,
                                  normal: {
                                      color: '#666',
                                      borderColor: '#666'
                                  },
                                  emphasis: {
                                      color: '#aaa',
                                      borderColor: '#aaa'
                                  }
                              },
                              data: data.map(function (ele) {
                                  return ele.time
                              })
                          },
                          backgroundColor: '#5c2223',
                          title: {
                              text: '1970-2020年全球恐怖袭击发生次数分布',
                              left: 'center',
                              top: 'top',
                              textStyle: {
                                  fontSize: 25,
                                  color: 'rgba(255,255,255, 0.9)'
                              }
                          },
                          tooltip: {
                              formatter: function (params) {
                                  return params.name + ":" + params.value;
                              }
                          },
                          grid: {
                              left: '15%',
                              right: '45%',
                              top: '70%',
                              bottom: 20
                          },
                          xAxis: {},
                          yAxis: {},
                          series: [{
                              id: 'map',
                              type: 'map',
                              map: mapName,
                              top: '10%',
                              bottom: '35%',
                              // left: 10,
                              itemStyle: {
                                  normal: {
                                      areaColor: '#323c48',
                                      borderColor: '#404a59'
                                  },
                                  emphasis: {
                                      label: {
                                          show: true
                                      },
                                      areaColor: 'rgba(255,255,255, 0.5)'
                                  }
                              },
                              data: []
                          }, {
                              id: 'bar',
                              type: 'bar',
                              tooltip: {
                                  show: true
                              },
                              label: {
                                  normal: {
                                      show: true,
                                      position: 'right',
                                      textStyle: {
                                          color: '#ddd'
                                      }
                                  }
                              },
                              data: []
                          }, {
                              id: 'pie',
                              type: 'pie',
                              radius: ['8%', '20%'],
                              center: ['75%', '85%'],
                              roseType: 'radius',
                              tooltip: {
                                  formatter: '{b} {d}%'
                              },
                              data: [],
                              label: {
                                  normal: {
                                      textStyle: {
                                          color: '#ddd'
                                      }
                                  }
                              },
                              labelLine: {
                                  normal: {
                                      lineStyle: {
                                          color: '#ddd'
                                      }
                                  }
                              },
                              itemStyle: {
                                  normal: {
                                      borderColor: 'rgba(0,0,0,0.3)',
                                      borderSize: 1
                                  }
                              }
                          }]
                      },
                      options: []
                  }
    
                  for (var i = 0; i < data.length; i++) {
                      var dt = data[i].data;
                      dt.sort(function (a, b) {
                          return a.count - b.count;
                      });
    
                      dt = dt.map(function (item) {
                          return { name: item['country'], value: item['count'] };
                      });
                      //console.log(data[i].data.at(-1));
    
                      var restPercent = 1;
                      var restValue = 0;
                      data[i].data.slice(-10).forEach(function (ele) {
                          restPercent = restPercent - ele.count / data[i].sum;
                      });
                      restValue = data[i].data.at(-1).count * (restPercent / (data[i].data.at(-1).count / data[i].sum));
                      mapOption.options.push({
                          visualMap: [{
                              dimension: 0,
                              left: '10%',
                              top: '35%',
                              bottom: '30%',
                              itemWidth: 12,
                              min: 1,
                              max: data[i].max,
                              text: ['High', 'Low'],
                              textStyle: {
                                  color: '#ddd'
                              },
                              inRange: {
                                  color: ['lightskyblue', 'yellow', 'orangered', 'red']
                              },
                              calculable: true
                          }],
                          xAxis: {
                              type: 'value',
                              boundaryGap: [0, 0.1],
                              axisLabel: {
                                  show: true,
                              }
                          },
                          yAxis: {
                              type: 'category',
                              axisLabel: {
                                  show: true,
                                  textStyle: {
                                      show: true,
                                      color: '#ddd'
                                  }
                              },
                              data: data[i].data.map(function (ele) {
                                  return ele.country;
                              }).slice(-10)
                          },
                          series: [{
                              id: 'map',
                              data: data[i].data.map(function (item) {
                                  return { name: item['country'], value: item['count'] };
                              })
                          }, {
                              id: 'bar',
                              data: data[i].data.map(function (ele) {
                                  return ele.count
                              }).sort(function (a, b) {
                                  return a > b
                              }).slice(-10)
                          }
                              ,
                          {
                              id: 'pie',
                              data: data[i].data.slice(-10).map(function (item) {
                                  return { name: item['country'], value: item['count'] };
                              }).concat({
                                  name: '其他国家',
                                  value: restValue
                              }),
                          }
                          ]
                      })
                  }
                  myChart.setOption(mapOption);
    
              })
    
          }
          )
    
      }
    
    
      function digInMap(mapName) {
          var mapData = './map/' + mapName + '.json';
          $.getJSON(mapData, function (mapJson) {
              echarts.registerMap(mapName, mapJson);
              console.log(mapJson);
              var time = ['1980', '1990', '2000', '2010', '2020'];
              $.getJSON("./Result.json", function (data) {
                  var mapOption = {
                      baseOption: {
                          animationDurationUpdate: 1000,
                          animationEasingUpdate: 'quinticInOut',
                          timeline: {
                              axisType: 'category',
                              orient: 'vertical',
                              autoPlay: true,
                              inverse: true,
                              playInterval: 5000,
                              left: null,
                              right: 5,
                              top: 20,
                              bottom: 20,
                              width: 46,
                              height: null,
                              label: {
                                  normal: {
                                      textStyle: {
                                          color: '#ddd'
                                      }
                                  },
                                  emphasis: {
                                      textStyle: {
                                          color: '#fff'
                                      }
                                  }
                              },
                              symbol: 'none',
                              lineStyle: {
                                  color: '#555'
                              },
                              checkpointStyle: {
                                  color: '#bbb',
                                  borderColor: '#777',
                                  borderWidth: 1
                              },
                              controlStyle: {
                                  showNextBtn: false,
                                  showPrevBtn: false,
                                  normal: {
                                      color: '#666',
                                      borderColor: '#666'
                                  },
                                  emphasis: {
                                      color: '#aaa',
                                      borderColor: '#aaa'
                                  }
                              },
                              data: time
                          },
                          backgroundColor: '#5c2223',
                          title: {
                              text: '1970-2020年全球恐怖袭击发生次数分布',
                              left: 'center',
                              top: 'top',
                              textStyle: {
                                  fontSize: 25,
                                  color: 'rgba(255,255,255, 0.9)'
                              }
                          },
                          tooltip: {
                              formatter: function (params) {
                                  return params.name + ":" + params.value;
                              }
                          },
                          grid: {
                              left: '15%',
                              right: '45%',
                              top: '70%',
                              bottom: 20
                          },
                          xAxis: {},
                          yAxis: {},
                          series: [{
                              id: 'map',
                              type: 'map',
                              top: '10%',
                              bottom: '35%',
                              // left: 10,
                              roam: false,
                              map: mapName,
                              animationDurationUpdate: 1500,
                              universalTransition: true,
                              data: []
                          }, {
                              id: 'bar',
                              type: 'bar',
                              tooltip: {
                                  show: true
                              },
                              label: {
                                  normal: {
                                      show: true,
                                      position: 'right',
                                      textStyle: {
                                          color: '#ddd'
                                      }
                                  }
                              },
                              data: []
                          }, {
                              id: 'pie',
                              type: 'pie',
                              radius: ['8%', '20%'],
                              center: ['75%', '85%'],
                              roseType: 'radius',
                              tooltip: {
                                  formatter: '{b} {d}%'
                              },
                              data: [],
                              label: {
                                  normal: {
                                      textStyle: {
                                          color: '#ddd'
                                      }
                                  }
                              },
                              labelLine: {
                                  normal: {
                                      lineStyle: {
                                          color: '#ddd'
                                      }
                                  }
                              },
                              itemStyle: {
                                  normal: {
                                      borderColor: 'rgba(0,0,0,0.3)',
                                      borderSize: 1
                                  }
                              }
                          }]
                      },
                      options: []
                  }
    
                  for (var i = 1980; i <= 2020; i += 10) {
                      console.log(i);
                      var dt = data.filter((dt) => { return dt['country'] == mapName && dt['iyear'] == i; });
                      console.log(dt);
                      if(dt.length==0)
                          {
                              mapOption.baseOption.timeline.data.splice((i-1980)/10,1);
                              console.log(mapOption.baseOption.timeline.data);
                              continue;
                          }
    
                      dt.sort(function (a, b) {
                          return a.cnt - b.cnt;
                      });
                      let max = dt.at(-1)['cnt'];
                      if(max == 1)max = 5;
                      dt = dt.map(function (item) {
                          return { name: item['province'], value: item['cnt'] };
                      });
                      
    
                      mapOption.options.push({
                          visualMap: [{
                              dimension: 0,
                              left: '15%',
                              top: '30%',
                              bottom: '35%',
                              itemWidth: 12,
                              min: 1,
                              max: max,
                              text: ['High', 'Low'],
                              textStyle: {
                                  color: '#ddd'
                              },
                              inRange: {
                                  color: ['lightskyblue', 'yellow', 'orangered', 'red']
                              },
                              calculable: true
                          }],
                          xAxis: {
                              type: 'value',
                              boundaryGap: [0, 0.1],
                              axisLabel: {
                                  show: true,
                              }
                          },
                          yAxis: {
                              type: 'category',
                              axisLabel: {
                                  show: true,
                                  textStyle: {
                                      show: true,
                                      color: '#ddd'
                                  }
                              },
                              data: dt.map(function (ele) {
                                  return ele.name;
                              }).slice(-10)
                          },
                          series: [{
                              id: 'map',
                              data: dt,
                              animationDurationUpdate: 1500,
                              universalTransition: true,
                          }, {
                              id: 'bar',
                              data: dt.map(function (ele) {
                                  return ele.value;
                              }).slice(-10)
                          }
    
                          ]
                      })
                      myChart.setOption(mapOption);
    
                  }
              })
          })
    
      }
    
      loadMap('world');
      //digInMap('China');
    
      myChart.on('click', function (param) {
          console.log(param.name);
          //loadMap(param.name);
          digInMap(param.name);
      });
      document.oncontextmenu = function () { loadMap('world'); return false; };
    
      if (option && typeof option === 'object') {
          myChart.setOption(option);
      }
    
    </script>
                
            </div>
        </div>
        




        <div class="main_right fr">
            <div class="right_1">
                <!--左上边框-->
                <div class="t_line_box">
                    <i class="t_l_line"></i> 
                    <i class="l_t_line"></i> 
                </div> 
                <!--右上边框-->
                <div class="t_line_box">
                    <i class="t_r_line"></i> 
                    <i class="r_t_line"></i> 
                </div> 
                <!--左下边框-->
                <div class="t_line_box">
                    <i class="l_b_line"></i> 
                    <i class="b_l_line"></i> 
                </div> 
                    <!--右下边框-->
                    <div class="t_line_box">
                    <i class="r_b_line"></i> 
                    <i class="b_r_line"></i> 
                </div> 
               
                <div id="containers" style="height: 100%"></div>

  
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom = document.getElementById('containers');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    
    var option;

    function getVirtualData(year) {
  const date = +echarts.time.parse(year + '-01-01');
  const end = +echarts.time.parse(+year + 1 + '-01-01');
  const dayTime = 3600 * 24 * 1000;
  const data = [];
  for (let time = date; time < end; time += dayTime) {
    data.push([
      echarts.time.format(time, '{yyyy}-{MM}-{dd}', false),
      Math.floor(Math.random() * 50000)
    ]);
  }
  return data;
}
option = {
    title: {
  show: true,
  text: '恐怖袭击热力图时间分布',
  textStyle: {
    fontSize: 25,
    fontWeight: 'bold',
    color: '#fff' // 设置为白色
  },
  left: 'center',
  top: 10
},

  tooltip: {
    position: 'top',
    formatter: function (p) {
      const format = echarts.time.format(p.data[0], '{yyyy}-{MM}-{dd}', false);
      return format + ': ' + p.data[1];
    }
  },
  visualMap: {
    min: 0,
    max: 50000,
    calculable: true,
    orient: 'vertical',
    left: '10',
    top: 'center',
    textStyle: {
    color: '#fff' // 设置为白色
  }
  },
  calendar: [
    {
      left: 120,
      cellSize: [20, 'auto'],
      bottom: 10,
      orient: 'vertical',
      range: '2017',
      textStyle: {
        color: '#fff' // 设置为白色
        },
      yearLabel: {
    show: false
        },
      dayLabel: {
        margin: 5
      },
      
    }
  ],
  series: [
    
    {
      type: 'heatmap',
      coordinateSystem: 'calendar',
      data: getVirtualData('2017')
    }
  ]
};

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
  </script>
            </div>
          
        </div>
    </div>
    <div class="data_bottom">
        <div class="bottom_1 fl t_btn5" style="cursor: pointer;">
            <!--左上边框-->
            <div class="t_line_box">
                <i class="t_l_line"></i> 
                <i class="l_t_line"></i> 
            </div> 
            <!--右上边框-->
            <div class="t_line_box">
                <i class="t_r_line"></i> 
                <i class="r_t_line"></i> 
            </div> 
            <!--左下边框-->
            <div class="t_line_box">
                <i class="l_b_line"></i> 
                <i class="b_l_line"></i> 
            </div> 
                <!--右下边框-->
                <div class="t_line_box">
                <i class="r_b_line"></i> 
                <i class="b_r_line"></i> 
            </div>
            <div class="main_title">
                <img src="img/t_6.png" alt="">
                全球恐怖袭击次数
            </div>
            <div id="container9" style="height: 100%"></div>

  
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom = document.getElementById('container9');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    
    var option;

    option = {

  tooltip: {
    trigger: 'axis'
  },
  legend: {
    data: ['袭击次数', '死亡人数', '伤残人数']
  },
  grid: {
    left: '3%',
    right: '4%',
    bottom: '3%',
    containLabel: true
  },
  toolbox: {
    feature: {
      saveAsImage: {}
    }
  },
  xAxis: {
    type: 'category',
    boundaryGap: false,
    
    data: ['1970','1971','1972','1973','1974','1975','1976','1977','1978','1979','1980','1981','1982','1983','1984','1985','1986','1987','1988','1989','1990','1991','1992','1993','1994','1995','1996','1997','1998','1999','2000','2001','2002','2003','2004','2005','2006','2007','2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020'],
    axisLine: {
          lineStyle: {
            color: '#fff' // 设置横轴线颜色为白色
          }}

  },
  yAxis: {
    type: 'value',
    axisLine: {
          lineStyle: {
            color: '#fff' // 设置横轴线颜色为白色
          }}
   
  },
  series: [
    {
      name: '全球恐怖袭击次数',
      type: 'line',
      stack: 'Total',
      data: [651,471,567,473,581,740,923,1319,1526,2662,2661,2586,2543,2870,3495,2914,2860,3183,3720,4324,3886,4685,5071,3456,3081,3058,3198,934,1396,1823,1912,1330,1280,1164,2017,2757,3250,4801,4723,4827,5075,8525,12047,16960,15138,14051,11364,9853,8537,8438]
    },
  ]
};

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
  </script>
            
        </div>
        
        <div class="bottom_center fl">
            <div class="bottom_2 fl">
                <!--左上边框-->
                <div class="t_line_box">
                <i class="t_l_line"></i> 
                <j class="l_t_line"></j> 
                </div> 
                <!--右上边框-->
                <div class="t_line_box">
                <i class="t_r_line1"></i> 
                <i class="r_t_line1"></i> 
                </div> 
                <!--左下边框-->
                <div class="t_line_box">
                    <i class="l_b_line"></i> 
                    <i class="b_l_line"></i> 
                </div> 
                    <!--右下边框-->
                    <div class="t_line_box">
                    <i class="r_b_line1"></i> 
                    <i class="b_r_line1"></i> 
                 </div>
    
                 <div id="container0" style="height: 100%"></div>

  
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
  <!-- Uncomment this line if you want to dataTool extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/dataTool.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use gl extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
  -->
  <!-- Uncomment this line if you want to echarts-stat extension
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
  -->
  <!-- Uncomment this line if you want to use map
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
  -->
  <!-- Uncomment these two lines if you want to use bmap extension
  <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
  <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/bmap.min.js"></script>
  -->

  <script type="text/javascript">
    var dom = document.getElementById('container0');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });
    var app = {};
    
    var option;

    option = {
  tooltip: {
    trigger: 'axis',
    axisPointer: {
      type: 'line',
      lineStyle: {
        color: 'rgba(0,0,0,0.2)',
        width: 1,
        type: 'solid'
      }
    }
  },
  title: {
            text: '1970-2020年全球恐怖袭击波及人数地区统计',
            left: 'center',
            top: 'bottom',
            textStyle: {
                fontSize: 15,
                color: 'rgba(255,255,255, 0.9)'
            }
        },
  legend: {
    data: ['Australasia & Oceania', 'Central America & Caribbean', 'Central Asia', 'East Asia', 'Eastern Europe', 'Middle East & North Africa','North America','South America','South Asia','Southeast Asia','Sub-Saharan Africa','Western Europe'],
    textStyle: {
    color: '#fff' // 修改字体颜色为白色
  }
  },
  singleAxis: {
    top: 50,
    bottom: 50,
    axisTick: {},
    axisLabel: {},
    type: 'time',
    axisPointer: {
      animation: true,
      label: {
        show: true
      }
    },
    splitLine: {
      show: true,
      lineStyle: {
        type: 'dashed',
        opacity: 0.2
      }
    },
    axisLine: {
          lineStyle: {
            color: '#fff' // 设置横轴线颜色为白色
          }}
  },
  series: [
    {
      type: 'themeRiver',
      emphasis: {
        itemStyle: {
          shadowBlur: 20,
          shadowColor: 'rgba(0, 0, 0, 0.8)'
        },
        label: {
    color: '#fff' // 修改字体颜色为白色
  }
      },
      data: [
         ['1970', 16, 'Australasia & Oceania'],
        ['1980', 78, 'Australasia & Oceania'],
        ['1990', 113, 'Australasia & Oceania'],
        ['2000', 25, 'Australasia & Oceania'],
        ['2010', 93, 'Australasia & Oceania'],
        ['1970', 918, 'Central America & Caribbean'],
        ['1980', 7490, 'Central America & Caribbean'],
        ['1990', 1847, 'Central America & Caribbean'],
        ['2000', 59, 'Central America & Caribbean'],
        ['2010', 72, 'Central America & Caribbean'],
        ['1970', 0, 'Central Asia'],
        ['1980', 0, 'Central Asia'],
        ['1990', 335, 'Central Asia'],
        ['2000', 148, 'Central Asia'],
        ['2010', 97, 'Central Asia'],

        ['1970', 78, 'East Asia'],
        ['1980', 110, 'East Asia'],
        ['1990', 416, 'East Asia'],
        ['2000', 88, 'East Asia'],
        ['2010', 155, 'East Asia'],

        ['1970', 26, 'Eastern Europe'],
        ['1980', 43, 'Eastern Europe'],
        ['1990', 1062, 'Eastern Europe'],
        ['2000', 1325, 'Eastern Europe'],
        ['2010', 2870, 'Eastern Europe'],

        ['1970', 1090, 'Middle East & North Africa'],
        ['1980', 2883, 'Middle East & North Africa'],
        ['1990', 5423, 'Middle East & North Africa'],
        ['2000', 8107, 'Middle East & North Africa'],
        ['2010', 40749, 'Middle East & North Africa'],

        ['1970', 1596, 'North America'],
        ['1980', 557, 'North America'],
        ['1990', 658, 'North America'],
        ['2000', 292, 'North America'],
        ['2010', 744, 'North America'],

        ['1970', 1009, 'South America'],
        ['1980', 9698, 'South America'],
        ['1990', 5763, 'South America'],
        ['2000', 1150, 'South America'],
        ['2010', 2226, 'South America'],

        ['1970', 51, 'South Asia'],
        ['1980', 2871, 'South Asia'],
        ['1990', 4838, 'South Asia'],
        ['2000', 8028, 'South Asia'],
        ['2010', 38937, 'South Asia'],

        ['1970', 193, 'Southeast Asia'],
        ['1980', 1086, 'Southeast Asia'],
        ['1990', 1643, 'Southeast Asia'],
        ['2000', 2707, 'Southeast Asia'],
        ['2010', 8869, 'Southeast Asia'],

        ['1970', 242, 'Sub-Saharan Africa'],
        ['1980', 1576, 'Sub-Saharan Africa'],
        ['1990', 2688, 'Sub-Saharan Africa'],
        ['2000', 1720, 'Sub-Saharan Africa'],
        ['2010', 17520, 'Sub-Saharan Africa'],

        ['1970', 4694, 'Western Europe'],
        ['1980', 4764, 'Western Europe'],
        ['1990', 3979, 'Western Europe'],
        ['2000', 1408, 'Western Europe'],
        ['2010', 2483, 'Western Europe'],
       
      ]
    }
  ]
};

    if (option && typeof option === 'object') {
      myChart.setOption(option);
    }

    window.addEventListener('resize', myChart.resize);
  </script>

        </div>
    </div>
        <div class="bottom_4 fr">
            <!--左上边框-->
            <div class="t_line_box">
                <i class="t_l_line"></i> 
                <i class="l_t_line"></i> 
            </div> 
            <!--右上边框-->
            <div class="t_line_box">
                <i class="t_r_line"></i> 
                <i class="r_t_line"></i> 
            </div> 
            <!--左下边框-->
            <div class="t_line_box">
                <i class="l_b_line"></i> 
                <i class="b_l_line"></i> 
            </div> 
                <!--右下边框-->
                <div class="t_line_box">
                <i class="r_b_line"></i> 
                <i class="b_r_line"></i> 
            </div>
            <div class="main_title">
                <img src="img/t_7.png" alt="">
               恐怖袭击手段词云图
            </div>
            <div id="main"  style="height: 100%"></div>
            <script src='https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js'></script>

        <!-- <script src="../../echarts/dist/echarts.js"></script> -->
        <script type="text/javascript" src='./wordcloud.js'></script>
        <script type="text/javascript">
            var chart = echarts.init(document.getElementById('main'));

            var keywords = {
              "Vehicle": 186,
              "Biological":	36,
              "Chemical": 347,
              "Equipment": 187,
              "Explosives": 103475,
              "Fake": 35,
              "Firearms": 67648,
              "Incendiary": 13133,
              "Melee": 4307,
              "Other": 136,
              "Radiological": 13,
              "Sabotage": 18,
              "Weapon": 35,
              "bombs": 186,
              "car": 186,
              "explosives": 186,
              "truck": 186,
              "vehicle-borne": 186
              
            };

            var data = [];
            for (var name in keywords) {
                data.push({
                    name: name,
                    value: Math.sqrt(keywords[name])
                })
            }

            var maskImage = new Image();

            var option = {
        
                series: [ {
                    type: 'wordCloud',
                    sizeRange: [10, 40],
                    rotationRange: [0, 0],
                    gridSize: 10,
                    shape: 'pentagon',
                    maskImage: maskImage,
                    drawOutOfBound: false,
                    // layoutAnimation: true,
                    keepAspect: true,
                    textStyle: {
                        fontWeight: 'bold',
                        color: function () {
                            return 'rgb(' + [
                                256,
                                256,
                                256
                            ].join(',') + ')';
                        }
                    },
                    emphasis: {
                        textStyle: {
                            color: '#f12'
                          
                        },
                        formatter: function (params) {
          return params.data.name + ': ' + keywords[params.data.name];
        }
                    },
                    data: data.sort(function (a, b) {
                        return b.value  - a.value;
                    })
                } ],
                tooltip: {
      formatter: function (params) {
        return params.data.name + ': ' + keywords[params.data.name];
      }
    }
            };

            maskImage.onload = function () {
                option.series[0].maskImage
                chart.setOption(option);
            }

            maskImage.src = './logo.png';

            window.onresize = function () {
                chart.resize();
            }

        </script>
        </div>
    </div>
</div>

</body>
<script src="js/jquery-2.2.1.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/common.js"></script>
<script src="js/echarts.min.js"></script>
<script src="js/dataTool.js"></script>
<script src="js/index.js"></script>
<script src="js/china.js"></script>
<script src="js/hunan.js"></script>
<script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<!-- <script type="text/javascript" src="http://zhangmuchen.top/file/dep/echarts/map/js/world.js"></script> -->

<script type="text/javascript">
  var dom = document.getElementById("chart-panel");
  var myChart = echarts.init(dom);
  var option;
  var app = {};
  var attackType=['Assassination','Hijacking','Kidnapping','Barricade incident','Bombing/Explosion','Armed Assault','Unarmed Assault','Facility','Unknown'];
  var attackIntroduction=['Assassination: The targeted killing of a specific individual, usually for political, ideological, or revenge purposes.','Hijacking: The act of seizing control of a vehicle, such as an airplane or a ship, by force, often with the intention of using it as a means of transportation to a different destination or for making demands.','Kidnapping: The unlawful abduction or taking away of a person against their will, usually for ransom, political leverage, or other unlawful motives.','Barricade incident: A situation where individuals or a group erects barricades or blockades, often in public areas, to impede the movement of people or authorities, usually as a form of protest or resistance.','Bombing/Explosion: The deliberate detonation of an explosive device, resulting in a violent and destructive blast, causing damage, injury, and loss of life.','Armed Assault: A coordinated attack carried out by individuals or a group using firearms, explosives, or other weapons to cause harm, destruction, or intimidation.','Unarmed Assault: An attack or aggression perpetrated by individuals or a group without the use of weapons, relying on physical force, intimidation, or other non-lethal means.','Facility: An attack targeting a specific location or facility, such as a government building, military installation, or critical infrastructure, with the intention of causing damage, disruption, or sending a message.','Unknown: An attack where the specific type or nature of the incident is unidentified, or the available information does not fit into any predefined attack category.']

  function loadMap(mapName) {
      var mapData;
      if (mapName != "world") {
          mapData = './map/' + mapName + '.json';
      }
      else {
          mapData = './world.json';
      }
      $.getJSON(mapData, function (mapJson) {
          echarts.registerMap(mapName, mapJson);

          $.getJSON("./1970-1980country.json", function (data) {

              var mapOption = {
                  baseOption: {
                      animationDurationUpdate: 1000,
                      animationEasingUpdate: 'quinticInOut',
                      timeline: {
                          axisType: 'category',
                          orient: 'vertical',
                          autoPlay: true,
                          inverse: true,
                          playInterval: 5000,
                          left: null,
                          right: 5,
                          top: 20,
                          bottom: 20,
                          width: 46,
                          height: null,
                          label: {
                              normal: {
                                  textStyle: {
                                      color: '#ddd'
                                  }
                              },
                              emphasis: {
                                  textStyle: {
                                      color: '#fff'
                                  }
                              }
                          },
                          symbol: 'none',
                          lineStyle: {
                              color: '#555'
                          },
                          checkpointStyle: {
                              color: '#bbb',
                              borderColor: '#777',
                              borderWidth: 1
                          },
                          controlStyle: {
                              showNextBtn: false,
                              showPrevBtn: false,
                              normal: {
                                  color: '#666',
                                  borderColor: '#666'
                              },
                              emphasis: {
                                  color: '#aaa',
                                  borderColor: '#aaa'
                              }
                          },
                          data: data.map(function (ele) {
                              return ele.time
                          })
                      },
                      backgroundColor: '#5c2223',
                      title: {
                          text: '1980-2020年全球恐怖袭击发生次数分布',
                          left: 'center',
                          top: 'top',
                          textStyle: {
                              fontSize: 25,
                              color: 'rgba(255,255,255, 0.9)'
                          }
                      },
                      tooltip: {
    formatter: function (params) {
      const attackIntro = attackIntroduction[params.value % attackIntroduction.length];
      const introWords = attackIntro.split(' ');
      let introText = '';
      for (let i = 0; i < introWords.length; i++) {
        if (i > 0 && i % 10 === 0) {
          introText += '<br/>';
        }
        introText += introWords[i] + ' ';
      }
      
      return `<div class="custom-tooltip">
                <span class="tooltip-title">${params.name}</span>: ${params.value}<br/>
                <span class="tooltip-label">Attack Type:</span> ${attackType[params.value % attackType.length]}<br/>
                <span class="tooltip-text">Attack Intro:</span> ${introText}
              </div>`;
    }
  },
                      grid: {
                          left: '15%',
                          right: '45%',
                          top: '70%',
                          bottom: 20
                      },
                      xAxis: {},
                      yAxis: {},
                      series: [{
                          id: 'map',
                          type: 'map',
                          map: mapName,
                          top: '10%',
                          bottom: '35%',
                          // left: 10,
                          itemStyle: {
                              normal: {
                                  areaColor: '#323c48',
                                  borderColor: '#404a59'
                              },
                              emphasis: {
                                  label: {
                                      show: true
                                  },
                                  areaColor: 'rgba(255,255,255, 0.5)'
                              }
                          },
                          data: []
                      }, {
                          id: 'bar',
                          type: 'bar',
                          tooltip: {
                              show: true
                          },
                          label: {
                              normal: {
                                  show: true,
                                  position: 'right',
                                  textStyle: {
                                      color: '#ddd'
                                  }
                              }
                          },
                          data: []
                      }, {
                          id: 'pie',
                          type: 'pie',
                          radius: ['8%', '20%'],
                          center: ['75%', '85%'],
                          roseType: 'radius',
                          tooltip: {
                              formatter: '{b} {d}%'
                          },
                          data: [],
                          label: {
                              normal: {
                                  textStyle: {
                                      color: '#ddd'
                                  }
                              }
                          },
                          labelLine: {
                              normal: {
                                  lineStyle: {
                                      color: '#ddd'
                                  }
                              }
                          },
                          itemStyle: {
                              normal: {
                                  borderColor: 'rgba(0,0,0,0.3)',
                                  borderSize: 1
                              }
                          }
                      }]
                  },
                  options: []
              }

              for (var i = 0; i < data.length; i++) {
                  var dt = data[i].data;
                  dt.sort(function (a, b) {
                      return a.count - b.count;
                  });

                  dt = dt.map(function (item) {
                      return { name: item['country'], value: item['count'] };
                  });
                  //console.log(data[i].data.at(-1));

                  var restPercent = 1;
                  var restValue = 0;
                  data[i].data.slice(-10).forEach(function (ele) {
                      restPercent = restPercent - ele.count / data[i].sum;
                  });
                  restValue = data[i].data.at(-1).count * (restPercent / (data[i].data.at(-1).count / data[i].sum));
                  mapOption.options.push({
                      visualMap: [{
                          dimension: 0,
                          left: '10%',
                          top: '35%',
                          bottom: '30%',
                          itemWidth: 12,
                          min: 1,
                          max: data[i].max,
                          text: ['High', 'Low'],
                          textStyle: {
                              color: '#ddd'
                          },
                          inRange: {
                              color: ['lightskyblue', 'yellow', 'orangered', 'red']
                          },
                          calculable: true
                      }],
                      xAxis: {
                          type: 'value',
                          boundaryGap: [0, 0.1],
                          axisLabel: {
                              show: true,
                          }
                      },
                      yAxis: {
                          type: 'category',
                          axisLabel: {
                              show: true,
                              textStyle: {
                                  show: true,
                                  color: '#ddd'
                              }
                          },
                          data: data[i].data.map(function (ele) {
                              return ele.country;
                          }).slice(-10)
                      },
                      series: [{
                          id: 'map',
                          data: data[i].data.map(function (item) {
                              return { name: item['country'], value: item['count'] };
                          })
                      }, {
                          id: 'bar',
                          data: data[i].data.map(function (ele) {
                              return ele.count
                          }).sort(function (a, b) {
                              return a > b
                          }).slice(-10)
                      }
                          ,
                      {
                          id: 'pie',
                          data: data[i].data.slice(-10).map(function (item) {
                              return { name: item['country'], value: item['count'] };
                          }).concat({
                              name: '其他国家',
                              value: restValue
                          }),
                      }
                      ]
                  })
              }
              myChart.setOption(mapOption);

          })

      }
      )

  }


  function digInMap(mapName) {
      var mapData = './map/' + mapName + '.json';
      $.getJSON(mapData, function (mapJson) {
          echarts.registerMap(mapName, mapJson);
          console.log(mapJson);
          var time = ['1980', '1990', '2000', '2010', '2020'];
          $.getJSON("./Result.json", function (data) {
              var mapOption = {
                  baseOption: {
                      animationDurationUpdate: 1000,
                      animationEasingUpdate: 'quinticInOut',
                      timeline: {
                          axisType: 'category',
                          orient: 'vertical',
                          autoPlay: true,
                          inverse: true,
                          playInterval: 5000,
                          left: null,
                          right: 5,
                          top: 20,
                          bottom: 20,
                          width: 46,
                          height: null,
                          label: {
                              normal: {
                                  textStyle: {
                                      color: '#ddd'
                                  }
                              },
                              emphasis: {
                                  textStyle: {
                                      color: '#fff'
                                  }
                              }
                          },
                          symbol: 'none',
                          lineStyle: {
                              color: '#555'
                          },
                          checkpointStyle: {
                              color: '#bbb',
                              borderColor: '#777',
                              borderWidth: 1
                          },
                          controlStyle: {
                              showNextBtn: false,
                              showPrevBtn: false,
                              normal: {
                                  color: '#666',
                                  borderColor: '#666'
                              },
                              emphasis: {
                                  color: '#aaa',
                                  borderColor: '#aaa'
                              }
                          },
                          data: time
                      },
                      backgroundColor: '#5c2223',
                      title: {
                          text: '1980-2020年全球恐怖袭击发生次数分布',
                          left: 'center',
                          top: 'top',
                          textStyle: {
                              fontSize: 25,
                              color: 'rgba(255,255,255, 0.9)'
                          }
                      },
                      tooltip: {
    formatter: function (params) {
      const attackIntro = attackIntroduction[params.value % attackIntroduction.length];
      const introWords = attackIntro.split(' ');
      let introText = '';
      for (let i = 0; i < introWords.length; i++) {
        if (i > 0 && i % 10 === 0) {
          introText += '<br/>';
        }
        introText += introWords[i] + ' ';
      }
      
      return `<div class="custom-tooltip">
                <span class="tooltip-title">${params.name}</span>: ${params.value}<br/>
                <span class="tooltip-label">Attack Type:</span> ${attackType[params.value % attackType.length]}<br/>
                <span class="tooltip-text">Attack Intro:</span> ${introText}
              </div>`;
    }
  },
                      grid: {
                          left: '15%',
                          right: '45%',
                          top: '70%',
                          bottom: 20
                      },
                      xAxis: {},
                      yAxis: {},
                      series: [{
                          id: 'map',
                          type: 'map',
                          top: '10%',
                          bottom: '35%',
                          // left: 10,
                          roam: false,
                          map: mapName,
                          animationDurationUpdate: 1500,
                          universalTransition: true,
                          data: []
                      }, {
                          id: 'bar',
                          type: 'bar',
                          tooltip: {
                              show: true
                          },
                          label: {
                              normal: {
                                  show: true,
                                  position: 'right',
                                  textStyle: {
                                      color: '#ddd'
                                  }
                              }
                          },
                          data: []
                      }, {
                          id: 'pie',
                          type: 'pie',
                          radius: ['8%', '20%'],
                          center: ['75%', '85%'],
                          roseType: 'radius',
                          tooltip: {
                              formatter: '{b} {d}%'
                          },
                          data: [],
                          label: {
                              normal: {
                                  textStyle: {
                                      color: '#ddd'
                                  }
                              }
                          },
                          labelLine: {
                              normal: {
                                  lineStyle: {
                                      color: '#ddd'
                                  }
                              }
                          },
                          itemStyle: {
                              normal: {
                                  borderColor: 'rgba(0,0,0,0.3)',
                                  borderSize: 1
                              }
                          }
                      }]
                  },
                  options: []
              }

              for (var i = 1980; i <= 2020; i += 10) {
                  console.log(i);
                  var dt = data.filter((dt) => { return dt['country'] == mapName && dt['iyear'] == i; });
                  console.log(dt);
                  if(dt.length==0)
                      {
                          mapOption.baseOption.timeline.data.splice((i-1980)/10,1);
                          console.log(mapOption.baseOption.timeline.data);
                          continue;
                      }

                  dt.sort(function (a, b) {
                      return a.cnt - b.cnt;
                  });
                  let max = dt.at(-1)['cnt'];
                  if(max == 1)max = 5;
                  dt = dt.map(function (item) {
                      return { name: item['province'], value: item['cnt'] };
                  });
                  

                  mapOption.options.push({
                      visualMap: [{
                          dimension: 0,
                          left: '15%',
                          top: '30%',
                          bottom: '35%',
                          itemWidth: 12,
                          min: 1,
                          max: max,
                          text: ['High', 'Low'],
                          textStyle: {
                              color: '#ddd'
                          },
                          inRange: {
                              color: ['lightskyblue', 'yellow', 'orangered', 'red']
                          },
                          calculable: true
                      }],
                      xAxis: {
                          type: 'value',
                          boundaryGap: [0, 0.1],
                          axisLabel: {
                              show: true,
                          }
                      },
                      yAxis: {
                          type: 'category',
                          axisLabel: {
                              show: true,
                              textStyle: {
                                  show: true,
                                  color: '#ddd'
                              }
                          },
                          data: dt.map(function (ele) {
                              return ele.name;
                          }).slice(-10)
                      },
                      series: [{
                          id: 'map',
                          data: dt,
                          animationDurationUpdate: 1500,
                          universalTransition: true,
                      }, {
                          id: 'bar',
                          data: dt.map(function (ele) {
                              return ele.value;
                          }).slice(-10)
                      }

                      ]
                  })
                  myChart.setOption(mapOption);

              }
          })
      })

  }

  loadMap('world');
  //digInMap('China');

  myChart.on('click', function (param) {
      console.log(param.name);
      //loadMap(param.name);
      digInMap(param.name);
  });
  document.oncontextmenu = function () { loadMap('world'); return false; };

  if (option && typeof option === 'object') {
      myChart.setOption(option);
  }

</script>
</html>